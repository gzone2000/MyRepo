
# Filebeat Install

## Filebeat Install

	su - elas
	wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.7.2-linux-x86_64.tar.gz
  	tar -zxvf filebeat-6.7.2-linux-x86_64.tar.gz

## Filebeat modules.d use

	  mv filebeat-6.7.2-linux-x86_64 filebeat6
	  cd /home/elas/filebeat6
	  wget https://github.com/iamtakgun/Start-Elastic-Stack/raw/master/sample/apache-access.log
	  

	  ./filebeat -c ./filebeat.yml modules enable apache2

	  ./filebeat -c ./filebeat.yml modules list
  
  	vi modules.d/apache2.yml
  
	  - module: apache2
	  # Access logs
	  access:
	    enabled: true
	    # Set custom paths for the log files. If left empty,
	    # Filebeat will choose the paths depending on your OS.
	    var.paths: ["/home/elas/filebeat6/apache-access.log"]
	  # Error logs
	  error:
	    enabled: false
	    # Set custom paths for the log files. If left empty,
	    # Filebeat will choose the paths depending on your OS.
	    #var.paths:
  

            vi filebeat.yml
	  
	  # Kibana
	  host: "localhost:5601"

              #-------------------------- Elasticsearch output ------------------------------
output.elasticsearch:
  hosts: ["localhost:9200"]

  
           # kibana, Elasticsearch Setting
	  ./filebeat -e -c ./filebeat.yml setup --modules apache2
	  --> kibana에게 시각화 포맷 그려달라고 함. 그럼 kibana > dashboard에 보면 여러가지 시각화 포맷 보임.

	  ./filebeat -e -c ./filebeat.yml
  
          # 1만건의 apache-log 데이터 다시 읽을려면
             cd /home/elas/filebeat6/data
	rm -f registry

	GET filebeat-6.7.2-*/_count




  # Filebeat + logstash use
  
  ## logstash 수정
	  input{
	  	beats{
		    port => 5044
		}
	  }
	  
	output {
        		elasticsearch{
		            hosts => ["192.168.63.103:9200"]
		            index => "filebeat-logstash-%{+yyyy-mm-dd}"
		}
    
    	    stdout{}
    	}


  ## Filebeat 수정	
  	output.elasticsearch 주석처리
	output.logstash 활성화

#output.elasticsearch:
  # Array of hosts to connect to.
  #hosts: ["192.168.63.103:9200"]

output.logstash:
  # The Logstash hosts
  hosts: ["192.168.63.103:5044"]

 ./filebeat -e -c ./filebeat.yml